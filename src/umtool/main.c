/*
 ============================================================================
 Name        : main.c
 Author      : Robert Abram, Katie Snow
 Version     :
 Copyright   : Copyright 2014 Robert Abram, Katie Snow
 Description : Ultimarc command line utility
 ============================================================================
 */

#include <sys/stat.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define DEFAULT_DEVICE "/dev/ultimarc0"

#include <libs/ultimarc.h>

int main(void) {
	char *dev;
	int   fd;
	int   retVal;

	char buf[] = { 0x50, 0xDD, 0x00, 0x00,
                   0xF5, 0xF4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x16, 0x00};
	
	
	puts("Nothing to do yet.");
	fprintf (stdout, "sizeof(buf) = %d\n", sizeof(buf));

	dev = DEFAULT_DEVICE;
	fd = open(dev, O_RDWR);

	puts("Open.");
	if (fd == -1)
	{
		perror("open");
		exit(1);
	}

	

	
	retVal = write (fd, &buf, sizeof(buf));
	//retVal = write (fd, NULL, 0);

	fprintf (stdout, "retVal=%d\n", retVal);
	if (retVal < 0)
	{
		fprintf (stderr, "Error occurred\n");
	}

	close (fd);

	foo();

	char *test = "{ \"admin\" : true, \"reviewer\" : false, \"author\" : true }";


	validate_json(test);

	//return 0;
	return EXIT_SUCCESS;

}
